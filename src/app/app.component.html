<div class="container">
  <header>
    <h1>Weather Dashboard</h1>
    <button class="unit" (click)="toggleUnit()">
      {{ unit() === "metric" ? "°C" : "°F" }}
    </button>
  </header>

  <form (ngSubmit)="onSearch()" class="search">
    <input
      [(ngModel)]="query"
      name="q"
      placeholder="Search city or zip"
      (input)="onType()"
    />
    <button type="submit">Search</button>
    <button type="button" class="ghost" (click)="useGeoloc()">
      Use my location
    </button>
  </form>

  <div *ngIf="loading()" class="loading">Loading…</div>
  <div *ngIf="error()" class="error">{{ error() }}</div>

  <section *ngIf="current()" class="current">
    <div class="title">{{ current()!.city }}, {{ current()!.country }}</div>
    <div class="row">
      <img [src]="iconUrl(current()!.icon)" alt="icon" />
      <div class="temp">{{ current()!.temp | number : "1.0-0" }}°</div>
      <div class="meta">
        <div>{{ current()!.description | titlecase }}</div>
        <div>Humidity: {{ current()!.humidity }}%</div>
        <div>
          Wind: {{ current()!.wind }} {{ unit() === "metric" ? "m/s" : "mph" }}
        </div>
      </div>
    </div>
    <div>
      Precipitation: {{ current()!.precipitation || 0 | number : "1.0-1" }} mm
    </div>
    <div>Sunrise: {{ current()!.sunrise | date : "shortTime" }}</div>
    <div>Sunset: {{ current()!.sunset | date : "shortTime" }}</div>
    <div *ngIf="current()!.aqi as aqi">
      Air Quality Index: {{ aqi }}
      <span class="aqi-badge" [attr.data-level]="aqi">{{ aqiLabel(aqi) }}</span>
    </div>
  </section>

  <section *ngIf="daily().length" class="forecast">
    <h2>5‑Day Forecast</h2>
    <div class="cards">
      <div class="card" *ngFor="let d of daily()">
        <div class="date">{{ d.date }}</div>
        <img [src]="iconUrl(d.icon)" alt="icon" />
        <div class="hi">{{ d.max }}°</div>
        <div class="lo">{{ d.min }}°</div>
        <div class="desc">{{ d.description }}</div>
      </div>
    </div>
  </section>

  <section *ngIf="hourly().length" class="hourly">
    <h2>Next 24 hours</h2>
    <div class="strip">
      <div class="hcard" *ngFor="let h of hourly()">
        <div class="h">{{ h.time }}</div>
        <img [src]="iconUrl(h.icon)" alt="icon" />
        <div class="t">{{ h.temp | number : "1.0-0" }}°</div>
      </div>
    </div>
  </section>

  <footer>
    <small>Data: OpenWeatherMap</small>
  </footer>
</div>
